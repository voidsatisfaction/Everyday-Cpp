<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=x-euc-jp">
<title>ロベールのＣ＋＋教室 - 第４８章 ビットでいじろう３ -</title>
</head>
<body bgcolor=white>

<center>
<font size=6>第４８章　ビットでいじろう３</font>
</center>
<hr>

<p>　今回も前回の続き、ビット演算について話します。今回はそのうちのＮＯＴとビットシフトについて話したいと思います。</p>

<hr>

<p>　今回の要点です。</p>

<font size=+2 color=red>
<ul>
<li>ＮＯＴ（論理否定）は全ビットを反転する。</li>
<li>ＮＯＴの演算子は ~ である。</li>
<li>ビットシフトはビットを左右にずらすことである。</li>
<li>ビットシフトの演算子は >> と << である。</li>
<li>ビットシフトは２の累乗での乗除に利用できる。</li>
</ul>
</font>
<p><br></p>

<p>　では、いってみましょう。</p>

<hr>

<p>　早速<font color=red>ＮＯＴ（論理否定）</font>についての話に入りましょう。Ｃ／Ｃ＋＋言語の<font color=red>演算子は ~</font> で、１つの数値から、１つの演算結果を導き出します。先ずは計算例を見てみましょう。（数値は２進数です。）</p>

<pre>~０１１１＝１０００</pre>

<p>　つまり、<font color=red>全ビットを反転</font>します。これがＮＯＴです。</p>

<p>　青が０、赤が１とすると、こんな感じになります。</p>

<table align=center>
<tr>
<td valign=center>~</td>
<td><img src="images/0104601.gif"></td>
<td valign=center>＝</td>
<td><img src="images/0104801.gif"></td>
</tr>
</table>

<p>　これは非常に簡単ですね。</p>

<hr>

<p>　さて、次はＮＯＴの利用法について話しましょう。</p>

<p>　先ずは、下の計算を見て下さい。</p>

<pre>　 ~００００１０００
――――――――――
　　１１１１０１１１
＆）０１１１１０１０
――――――――――
　　０１１１００１０</pre>

<p>　このように、ＮＯＴは普通<font color=red>ＡＮＤと組み合わせて、特定のビットを０にする</font>ときに使います。もちろんＡＮＤ単独でもできますが、ＮＯＴと組み合わせて使う方が便利で分かりやすいときがあります。このＮＯＴとＡＮＤを組み合わせた計算を、特に<font color=red>ＮＡＮＤ</font>と呼ぶことがあります。</p>

<hr>

<p>　次は<font color=red>ビットシフト</font>です。Ｃ／Ｃ＋＋言語の<font color=red>演算子は >> と <<</font> で、２つの数値から、１つの演算結果を導き出します。cout にもこの演算子を使うので、cout などと組み合わせて使うときは、全体をカッコで囲むようにしましょう。では、先ずは計算例を見てみましょう。（数値は２進数と１０進数の混在です。）</p>

<pre>　　０００１０１０１　　　０００１０１０１
＜＜　　　　　　　３　＞＞　　　　　　　２
――――――――――　――――――――――
　　１０１０１０００　　　０００００１０１</pre>

<p>　つまり、その名の通り<font color=red>ビットを右へ左へずらします</font>。これがビットシフトです。<font color=red>ビットの無くなってしまうところは０で埋められ、ビットの溢れてしまうところは切り捨てられてしまいます。</font></p>

<p>　これも非常に簡単ですね。</p>

<hr>

<p>　さて、次はビットシフトの利用法について話しましょう。</p>

<p>　先ずは、下の計算を見て下さい。</p>

<pre>　　００００１０１０　＝　１０
＜＜　　　　　　　３
――――――――――
　　０１０１００００　＝　８０</pre>

<p>　ビットを左に３ずらすと、値は８倍されました。この８というのは２の３乗です。これは偶然ではなく、こうなるものなのです。ビットを左に３つずらすということは、結局の所（１０００）<font size=-2>2</font>倍（＝８倍）することなのですから。</p>

<p>　１０進数で考えるともっとよくわかります。１２３を左に３つシフトすると１２３０００です。これは元の値を１０００（＝１０の３乗）倍したことになりますね。</p>

<p>　また、ビットを右にずらすと今度は割り算になります。このように、ビットシフトは<font color=red>２の累乗での乗除</font>に用いられます。</p>

<p>　ほかにも、第ｘビットを作り出すのにも使います。</p>

<pre>#define BIT(x)          (1 << (x))</pre>

<p>というマクロを作れば、BIT(0) で第０ビットのみが、BIT(4) で第４ビットのみが１になった値を表現することができます。</p>

<p>　また、for 文で</p>

<pre>unsigned int i, x = 105054;
for(i = 1; i; i <<=1)
{
    if(x & i)...
    else...
}</pre>

<p>のようにすると、第０ビットが１かどうか、第１ビットが１かどうか...と、ビットスキャンを行うことができます。</p>

<hr>

<p>　これで全てのビット演算子を紹介し終えました。最後に、ビット演算子を使って次の問題を解いてみて下さい。答は<!--a href="cpp01050.html" target=main"-->第５０章<!--/a-->で解説します。</p>

<blockquote><b>
<p>４４は４４、８１は８４、というように、その数以上の４の倍数のうち最も小さい数を求める式を作って下さい。</p>
</b></blockquote>

<p>　まぁ、とりあえず言っておきますが、別にビット演算子だけしか使っていけないわけではありません。それに、ビット演算子の全てを使うわけではありません。まぁ、頭の体操ということで。</p>

<hr>

<p>　では今回の要点です。</p>

<font size=+2 color=red>
<ul>
<li>ＮＯＴ（論理否定）は全ビットを反転する。</li>
<li>ＮＯＴの演算子は ~ である。</li>
<li>ビットシフトはビットを左右にずらすことである。</li>
<li>ビットシフトの演算子は >> と << である。</li>
<li>ビットシフトは２の累乗での乗除に利用できる。</li>
</ul>
</font>
<p><br></p>

<p>　次回はビット演算の花形、フラグ処理について話したいと思います。それでは。</p>

<hr>

<p align=right><a href="cpp01047.html" target="main">第４７章　ビットでいじろう２</a> | <a href="cpp01049.html" target="main">第４９章　ビットでフラグ</a></p>
<p align=right><font size=-1><i>Last update was done on 2000.1.20</i></font></p>

<p align=right><font size=-1><i>この講座の著作権は<a href="http://www1.kcn.ne.jp/~robe/">ロベール</a>が保有しています</i></font></p>

</body>
</html>
