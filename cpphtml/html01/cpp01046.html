<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=x-euc-jp">
<title>ロベールのＣ＋＋教室 - 第４６章 ビットでいじろう -</title>
</head>
<body bgcolor=white>

<center>
<font size=6>第４６章　ビットでいじろう</font>
</center>
<hr>

<p>　今までの演算は普通の数学的な演算子しか行ってきませんでした。しかし、今回から数回にかけては少し特殊な演算を行ってみます。</p>

<hr>

<p>　今回の要点です。</p>

<font size=+2 color=red>
<ul>
<li>ビット演算子は優先順位が低い。</li>
<li>ＡＮＤ（論理積）はそれぞれのビットについて、両方とも１のときは１を、それ以外のときは０を出力する。</li>
<li>ＡＮＤの演算子は & である。</li>
<li>ＡＮＤは特定のビットを取り出すのに使う。</li>
</ul>
</font>
<p><br></p>

<p>　では、いってみましょう。</p>

<hr>

<p>　前回ｎ進数についての話をしました。そして、コンピューターは２進数を使って動いているという話もしました。今回からは、この２進数をベースにした演算を行います。</p>

<p>　それは<font color=red>ビット演算</font>と呼ばれ、ＡＮＤ、ＯＲ、ＸＯＲ、ＮＯＴ、そしてビットシフトの５種類があります。何か難しい響きがしますが、その実体は非常に簡単なものです。では、今回から少しずつそのビット演算を体験してみましょう。</p>

<p>　で、先ず初めに注意です。ＮＯＴは例外として、ビット演算子は＋や−よりも優先順位が低いです。なので、</p>

<pre>1 + 5 & 1</pre>

<p>のように書くと、先ず 1 + 5 = 6 が行われ、そのあと 6 & 1 が行われます。何か不思議な感じがしますが、こういうものなので仕方がありません。<font color=red>このビット演算子の優先順位によるバグはかなり多い</font>ようで、筆者も注意していてもやってしまうことがあります。</p>

<p>　<font color=red>ビット演算子を使うときは、とりあえず手当たり次第カッコを付けておくのが無難かと思います。</font></p>

<hr>

<p>　先ずは、<font color=red>ＡＮＤ（論理積）</font>です。Ｃ／Ｃ＋＋言語の<font color=red>演算子は &</font> で、２つの数値から、１つの演算結果を導き出します。この辺は＋とか−とかと同じですね。計算方法より、先ずは計算例を見てみましょう。（数値は２進数です。）</p>

<pre>　　００１１
＆）０１０１
――――――
　　０００１</pre>

<p>　つまり、<font color=red>両方ともビットが１のところは１、それ以外は０</font>になります。これがＡＮＤです。</p>

<p>　青が０、赤が１とすると、こんな感じになります。</p>

<table align=center>
<tr>
<td><img src="images/0104601.gif"></td>
<td valign=center>＆</td>
<td><img src="images/0104602.gif"></td>
<td valign=center>＝</td>
<td><img src="images/0104603.gif"></td>
</tr>
</table>

<p>　ビット演算は論理演算が基本になっています。論理演算とは、その言葉の通り真と偽という論理を演算するものです。条件文での && や || などがそうです。ＡＮＤは丁度条件文の && と似ています（同じではありません！）。１を真、０を偽に見立ててビットごとにＡＮＤをとっていくのが、このＡＮＤという演算なのです。</p>

<hr>

<p>　さて、次はＡＮＤの利用法について話しましょう。</p>

<p>　先ずは、下の計算を見て下さい。</p>

<pre>　　０１１１１０１０
＆）００００１１１１
――――――――――
　　００００１０１０</pre>

<p>　この計算をＡ＆Ｂ＝Ｃとおきます。これを見れば分かるとおり、Ｂで０であるビットはＣでも全て０になっています。そして、Ｂで１であるビットはＡのものがそのままＣに現れています。つまり、<font color=red>Ａの上位４ビットが０にされた</font>、もしくは<font color=red>Ａの下位４ビットが取り出された</font>ということになります。</p>

<p>　つまり、<font color=red>取り出したいところのビットを１にした値を使えば、ＡＮＤをとることによって特定のビットを取り出すことができる</font>のです。これは逆に言えば、消したいところのビットを０にした値を使えば特定のビットを消せる、ということになります。</p>

<p>　いらないビットを０にして注目したいビットを取り出すというこの操作を<font color=red>マスキング</font>とも呼びます。ＡＮＤはもっぱらこのマスキングに使われます。</p>

<hr>

<p>　今回はこれで終わりです。では、最後に要点を。</p>

<font size=+2 color=red>
<ul>
<li>ビット演算子は優先順位が低い。</li>
<li>ＡＮＤ（論理積）はそれぞれのビットについて、両方とも１のときは１を、それ以外のときは０を出力する。</li>
<li>ＡＮＤの演算子は & である。</li>
<li>ＡＮＤは特定のビットを取り出すのに使う。</li>
</ul>
</font>
<p><br></p>

<p>　次回はＯＲとＸＯＲについて話します。それでは。</p>

<hr>

<p align=right><a href="cpp01045.html" target="main">第４５章　２進数と１６進数</a> | <a href="cpp01047.html" target="main">第４７章　ビットでいじろう２</a></p>
<p align=right><font size=-1><i>Last update was done on 2000.1.18</i></font></p>

<p align=right><font size=-1><i>この講座の著作権は<a href="http://www1.kcn.ne.jp/~robe/">ロベール</a>が保有しています</i></font></p>

</body>
</html>
